<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
	<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
	<style>
	
		body
		{
			width: 95%;
			height: 95%;
			background: url("images/b1.jpg");
			/*background-repeat: no-repeat;*/
			background-size: contain;
		}
		div.a
		{
			width: 100px;
			height:100px;
			position:fixed;
		}

		div.b
		{
			width: 100px;
			height:100px;
			position:fixed;
		}
		
		#content
		{
			position: absolute;
			top: 1%;
			left: 1%;
			font-size: 52px;
			font-family: Arial, Helvetica, sans-serif;
		}
	</style>
	<script>
		var first_prev = 0;
		var second_prev = 0;
		var alreadyPrinted = false;
		//var first_img = 0;
		//var second_img = 0;
		
		$(document).ready(function(){
			alert("ברוכים הבאים, מטרת המשחק היא ללחוץ על תמונת הרובוט. כל פעם שאתה לוחץ על הרובוט אתה מקבל נקודה. שים לב: אם אתה לוחץ על הליצן יורדת לך נקודה, ואם אתה לוחץ על המסך אתה מפסיד !")
			var first_div = document.getElementsByClassName("a");
			animateDiv('.a');
			animateDiv('.b');
		});

		function makeNewPosition(){
			
			// Get viewport dimensions (remove the dimension of the div)
			var h = $(window).height() - 100;
			var w = $(window).width() - 100;
			
			var nh = Math.floor(Math.random() * h);
			var nw = Math.floor(Math.random() * w);
			
			//while(first_img == first_prev || second_img == second_prev)
			//{
				var first_img = Math.floor(Math.random() * 3 + 1);
				var second_img = String(Math.floor(Math.random() * 3 + 4));
			//}
			
			if(first_img == first_prev)
			{
				if(first_img != 3)
				{
					first_img++;
				}
				else
				{
					first_img = 1;
				}
			}
			
			if(second_img == second_prev)
			{
				if(second_img != 6)
				{
					second_img++;
				}
				else
				{
					second_img = 4;
				}
			}
			
			first_prev = first_img;
			second_prev = second_img;
			
			//first_img = "images/img1.png";
			//second_img = "images/img4.png";
			return [nh,nw, first_img, second_img];
			//return [nh,nw];
			
		}

		function animateDiv(myclass){
			var newq = makeNewPosition();
			
			if(newq[2] != undefined && newq[3] != undefined)
			{
				var first = "images/img" + newq[2] + ".png";
				var second = "images/img" + newq[3] + ".png";
				
				document.getElementById("img_1").src = first;
				document.getElementById("img_2").src = second;
			}
			  
			$(myclass).animate({ top: newq[0], left: newq[1] }, 0,   function(){
			  setTimeout(function(){
				animateDiv(myclass);
			  },1000);
			});
		};
		
		function printScore()
		{
			if(!alreadyPrinted)
			{
				document.getElementById("wrap").style.display = "none";
				var header = document.createElement("h1");
				header.innerHTML = "עשית " + counter + " נקודות.";
				document.getElementById("header_div").appendChild(header);
				alreadyPrinted = true;
			}
		}
	</script>
</head>
<body>

	<div id = "wrap">
		<div class='a' id = "first_div"><img style = "width: 200px;height:100px;" id = "img_1"/></div>
		<div class='b' id = "second_div"><img style = "width: 200px;height:100px;" id = "img_2"/></div>
		<p id = "content">תוצאה: 0</p>
	</div>
	<div align = "Center" id = "header_div"></div>
	
	<script>
		var counter = 0;
		var first_clicked = false, second_clicked = false;
		var first_div = document.getElementById("first_div");
		var second_div = document.getElementById("second_div");
		var score_text = document.getElementById("content");
		
		first_div.addEventListener("click", function(){
			counter--;
			if(counter < 0)
				counter = 0;
			score_text.innerHTML = "תוצאה: " + counter;
			//first_clicked = true;
		});


		second_div.addEventListener("click", function(){
			if(!second_clicked)
			{
				//$( "#second_div" ).toggle( "explode" );
				//$( "#second_div" ).toggle( "explode" );
				counter++;
				score_text.innerHTML = "תוצאה: " + counter;
				//second_clicked = true;
			}
		});
		
		$('body').click(function(evt){
			console.log(evt.target.id);
			if(!(evt.target.id == "first_div" || evt.target.id == "second_div" || evt.target.id == "img_1" || evt.target.id == "img_2") && !alreadyPrinted)
			{
				alert("נגעת במסך - הפסדת !");
				printScore();
			}
		});
	</script>
	
	<script>
		setTimeout(function(){
				printScore();
		}, 20000);
	</script>
</body>
</html>